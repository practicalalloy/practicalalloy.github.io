<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-02-16T20:25:24+00:00" /><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="The predefined ordering module" href="../ordering/index.html" /><link rel="prev" title="Type system" href="../type-system/index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Module system - Practical Alloy</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=684c625f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/practicalalloy.css?v=2ee171b3" />
    <link crossorigin="anonymous" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: #2a5adf;
  --color-brand-content: #2a5adf;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Practical Alloy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Practical Alloy</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about-alloy/index.html">About Alloy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about-book/index.html">About this book</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../structural-modeling/index.html">Structural modeling</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Advanced topics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subset-signatures/index.html">Subset signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enumerations/index.html">Enumeration signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commands in detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/index.html">Visualization customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nary-relations/index.html">Higher-arity relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluator/index.html">The instance evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bestiary/index.html">Arrow multiplicity constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../type-system/index.html">Type system</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Module system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ordering/index.html">The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../relational-logic/index.html">A relational logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model-finding/index.html">Model finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-instances/index.html">Encoding test instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../recursion/index.html">Handling recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integers/index.html">Working with integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature-facts/index.html">Signature facts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../behavioral-modeling/index.html">Behavioral modeling</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../behavioral-topics/index.html">Advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/temporal-logic/index.html">A temporal logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/mutable-toplevel-signatures/index.html">Mutable top-level signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/pointwise-effects/index.html">Pointwise effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/macros/index.html">Macro system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/meta/index.html">Meta-capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/event-depiction/index.html">An idiom for event depiction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/scenarios/index.html">Encoding trace scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/evaluator/index.html">The trace evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/fairness/index.html">Safety, liveness, and fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/inductive-invariants/index.html">Inductive invariants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/sequences/index.html">Sequences</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../protocol-design/index.html">Protocol design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/chapters/structural-topics/topics/modules/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-system">
<span id="index-0"></span><span id="modules"></span><h1>Module system<a class="headerlink" href="#module-system" title="Link to this heading">¶</a></h1>
<p>Alloy provides a simple module system to promote the modularisation and
reusability of models. In other chapters we’ve already seen how to use some of
the utility modules that come packaged with the Analyzer. This chapter explores
how to create new ones.</p>
<section id="declaring-simple-modules">
<h2>Declaring simple modules<a class="headerlink" href="#declaring-simple-modules" title="Link to this heading">¶</a></h2>
<p id="index-1">To create a new module in Alloy you just need to create a new <code class="code docutils literal notranslate"><span class="pre">.als</span></code> file
and add it to the same directory as the main model, possibly inside other
sub-directories. You can declare the module name using the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">module</span></code>
keyword, but note that only the file name is used to search for modules to be
included. To include a module in another model, we must to use an <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">open</span></code>
instruction with the path to the corresponding file (without the <code class="code docutils literal notranslate"><span class="pre">.als</span></code>
extension). The <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">module</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">open</span></code> instructions must appear at
the top of the model, before any other declaration. After a module is opened all
its definitions are included in the main module, and you can refer to them by
their identifier directly, or use its full qualified name using a <code class="code docutils literal notranslate"><span class="pre">/</span></code>
separator. In particular, if the Analyzer is not able to disambiguate an
identifier, you may use the qualified name to disambiguate. If this becomes
cumbersome, you can open a module with an alias using the keyword <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">as</span></code>.</p>
<p>Let us get back to the file system example from the
<a class="reference internal" href="../../../structural-modeling/index.html#structural-modeling"><span class="std std-ref">Structural modeling</span></a> chapter. The constrains we have imposed on the file system mean that it is
actually a directed acyclic graph (DAG) where nodes are objects. Additionally, it is a rooted
graph, since there is a single node without a parent (<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Root</span></code>). This shape
is enforced by the combination of facts <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">no_indirect_containment</span></code> and
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">no_dangling_objects</span></code> in the original file system model, but since these
are common constraints on graph-like structures, it makes sense to provide them in a separate module to promote reusability.</p>
<p>Let us create a new Alloy model file and name it <code class="code docutils literal notranslate"><span class="pre">graph.als</span></code>. A binary
relation over a set of nodes defines a DAG if it is acyclic. So we can just
declare the following predicate, that checks this property for a given set of nodes and a binary adjacency relation over them.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">pred</span> <span class="nf">dag</span> <span class="o">[</span><span class="n">node</span> <span class="p">:</span> <span class="k">set</span> <span class="kc">univ</span><span class="p">,</span> <span class="n">r</span> <span class="p">:</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">all</span> <span class="n">n</span> <span class="p">:</span> <span class="n">node</span> <span class="o">|</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.^</span><span class="n">r</span>
<span class="o">}</span>
</pre></div>
</div>
<p>On the other hand, a graph has a root if all other nodes are reachable from that
node, a constraint that can be encoded as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">pred</span> <span class="nf">rootedAt</span> <span class="o">[</span><span class="n">node</span> <span class="p">:</span> <span class="k">set</span> <span class="kc">univ</span><span class="p">,</span> <span class="n">r</span> <span class="p">:</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span><span class="p">,</span> <span class="n">root</span> <span class="p">:</span> <span class="n">node</span><span class="o">]</span> <span class="o">{</span>
  <span class="n">node</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.*</span><span class="n">r</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Getting back to our file system model, the adjacency relation of the file system DAG is the
relation between directories  and the objects they contain, abstracting away the
intermediate entry atoms, that is, the composed relation
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span><span class="o">.</span><span class="n">object</span></code>. So, after including the new auxiliary model with
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">open</span> <span class="nn">graph</span></code>, we could just enforce the following fact in the main
module, replacing <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">no_indirect_containment</span></code> and
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">no_dangling_objects</span></code>.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">rooted_dag</span> <span class="o">{</span>
  <span class="n">dag</span><span class="o">[</span><span class="n">Object</span><span class="p">,</span> <span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">]</span>
  <span class="n">rootedAt</span><span class="o">[</span><span class="n">Object</span><span class="p">,</span> <span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Root</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Alternatively, we could have used the qualified names of the predicates as
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">graph</span><span class="o">/</span><span class="n">dag</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">graph</span><span class="o">/</span><span class="n">rootedAt</span></code>.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/declaring-simple-modules"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/declaring-simple-modules</span></a></div>
</div>
</section>
<section id="parametrized-modules">
<h2>Parametrized modules<a class="headerlink" href="#parametrized-modules" title="Link to this heading">¶</a></h2>
<p id="index-2">You may have noticed that all predicates declared above required as input the
set of nodes on which the graph if formed. This can get a bit cumbersome, and
can be avoided by using module parameters. Alloy modules can be declared with
signature parameters, that are specified by the including modules. These are
declared after its name in the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">module</span></code> declaration between square
brackets. These module parameters can be used as regular signatures in the
model, including as the type of fields and predicates. The parameter declaration
can also be marked with keyword <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">exactly</span></code>, which enforces an exact scope
on that signature.</p>
<p>For our example, we would declare the graph utilities module as
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">graph</span><span class="o">[</span><span class="n">node</span><span class="o">]</span></code> so that the set of nodes comprising the graph get specified
when the module is first opened. Then, the predicates within would be rewritten
assuming that the set of graph nodes is now provided as a parameter of the
module.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="kn">module</span> <span class="nn">graph</span><span class="o">[</span><span class="n">node</span><span class="o">]</span>

<span class="k">pred</span> <span class="nf">dag</span> <span class="o">[</span><span class="n">r</span> <span class="p">:</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">all</span> <span class="n">n</span> <span class="p">:</span> <span class="n">node</span> <span class="o">|</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.^</span><span class="n">r</span>
<span class="o">}</span>

<span class="k">pred</span> <span class="nf">rootedAt</span> <span class="o">[</span><span class="n">r</span> <span class="p">:</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span><span class="p">,</span> <span class="n">root</span> <span class="p">:</span> <span class="n">node</span><span class="o">]</span> <span class="o">{</span>
  <span class="n">node</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.*</span><span class="n">r</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note that you can still define commands in parametrized modules in order to
validate them. In that case module parameter signatures will be treated as any
arbitrary signature. For instance, we could write the following <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">run</span></code> command
in our graph module.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">run</span> <span class="n">dag_example</span> <span class="o">{</span>
  <span class="k">some</span> <span class="n">r</span> <span class="p">:</span> <span class="n">node</span> <span class="o">-&gt;</span> <span class="n">node</span> <span class="o">|</span> <span class="n">dag</span><span class="o">[</span><span class="n">r</span><span class="o">]</span>
<span class="o">}</span> <span class="k">for</span> <span class="k">exactly</span> <span class="mi">4</span> <span class="n">node</span>
</pre></div>
</div>
<p>This is an example of a higher-order quantification, possible in certain
contexts due to Skolemization. A possible resulting instance is shown below.</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/modules/instance_01/graph.als#L22-L27"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance122.png" style="width: 500px;" />
</a>
<p>Getting back to our file system example, we want to force a rooted DAG over file
system objects. So we include the graph module as <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">open</span> <span class="nn">graph</span><span class="o">[</span><span class="n">Object</span><span class="o">]</span></code>,
and then rewrite the fact <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">rooted_dag</span></code> as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">rooted_dag</span> <span class="o">{</span>
  <span class="n">dag</span><span class="o">[</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">]</span>
  <span class="n">rootedAt</span><span class="o">[</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Root</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p id="index-3">What we just defined is actually part of the utility module <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">graph</span></code>,
which builds on the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">relation</span></code> utility module. These come packaged
with the Analyzer, and contain many more common properties that can be tested
over relations and graphs. They can be inspected through menu option
<span class="menuselection">File ‣ Open Sample Models…</span>.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/parametrized-modules"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/parametrized-modules</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Model finding</div>
<p class="sd-card-text">We’ve used a higher-order quantification solved through Skolemization. Learn in detail how this works.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../model-finding/index.html#analysis"><span class="std std-ref">Model finding</span></a></div>
</div>
</section>
<section id="adding-fields-to-module-parameters">
<h2>Adding fields to module parameters<a class="headerlink" href="#adding-fields-to-module-parameters" title="Link to this heading">¶</a></h2>
<p>Sometimes it is useful for auxiliary modules to declare additional structures to be used in the main importing module. New signatures, possibly with fields, can be introduced
in the auxiliary module. However, we cannot declare new fields for the parameter signatures
that are passed by the main module. However, there are some workarounds to this limitation.</p>
<p>For the sake of example, let us try to encode a simple auxiliary module that
introduces timestamps in over a given signature. We’ll call this module
<code class="code docutils literal notranslate"><span class="pre">timestamp</span></code>, and it takes as a parameter the signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> to which
the timestamps will be assigned, and the signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">T</span></code> representing the
actual timestamps.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="kn">module</span> <span class="nn">timestamp</span><span class="o">[</span><span class="n">A</span><span class="p">,</span> <span class="n">T</span><span class="o">]</span>
</pre></div>
</div>
<p>Our timestamp module will be very simple for the sake of example: we want
timestamps to be comparable, to be assigned to every <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> atom, and to be
exhaustively used (i.e., no free dangling timestamps). To allow the comparison
of timestamps, we can impose a total ordering over <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">T</span></code> with the utility
module <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">ordering</span></code>.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="kn">open</span> <span class="nn">util</span><span class="o">/</span><span class="n">ordering</span><span class="o">[</span><span class="n">T</span><span class="o">]</span>
</pre></div>
</div>
<p>Next, we want to define a new binary relation that assigns timestamps from
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">T</span></code> to elements of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code>. We cannot introduce new fields in
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> directly, but we can introduce a new auxiliary singleton signature
with a ternary field between <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">T</span></code>, and then just project it
when needed.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">one</span> <span class="kd">sig</span> <span class="nc">TimeAux</span> <span class="o">{</span>
  <span class="n">aux_time</span> <span class="p">:</span> <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">T</span>
<span class="o">}</span>
</pre></div>
</div>
<p>For instance, to impose the desired multiplicity of the timestamp field, we can
enforce the following fact. Note that since <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code> is a singleton
signature, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span><span class="o">.</span><span class="n">aux_time</span></code> simply returns a binary relation between
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">T</span></code>.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">time_mult</span> <span class="o">{</span>
  <span class="n">TimeAux</span><span class="o">.</span><span class="n">aux_time</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">some</span> <span class="o">-&gt;</span> <span class="k">one</span> <span class="n">T</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now, let us get back to our file system model and include this module. We define
a new signature representing the timestamps, and then open the auxiliary module
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">timestamp</span></code> over the objects of the file system.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="kn">open</span> <span class="nn">timestamp</span><span class="o">[</span><span class="n">Object</span><span class="p">,</span> <span class="n">Timestamp</span><span class="o">]</span>

<span class="kd">sig</span> <span class="nc">Timestamp</span> <span class="o">{}</span>
</pre></div>
</div>
<p>Field <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">aux_time</span></code> is now accessible from the main module, and we can
impose additional restrictions on timestamps. For instance, we can force the
timestamps of the contents of a directory to be after the timestamp of the
directory itself as follows. Relation <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">next</span></code> is provided by
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">ordering</span></code> over the timestamps.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">time</span> <span class="o">{</span>
  <span class="k">all</span> <span class="n">d</span> <span class="p">:</span> <span class="n">Dir</span> <span class="o">|</span> <span class="n">d</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">.(</span><span class="n">TimeAux</span><span class="o">.</span><span class="n">aux_time</span><span class="o">)</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.(</span><span class="n">TimeAux</span><span class="o">.</span><span class="n">aux_time</span><span class="o">).*</span><span class="n">next</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The new elements will also show up in the visualizer, as follows. Notice how atoms introduced by other modules appear with the qualified name by default. This label can be changed by customizing the theme.</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/modules/instance_02/filesystem.als#L78-L90"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance29.png" style="width: 500px;" />
</a>
<p>While this strategy of defining a singleton auxiliary signature is perfectly functional, it is not ideal in terms of maintainability, since we have to keep projecting <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">aux_time</span></code>. Moreover, it appears as a ternary relation in the visualizer.</p>
<p id="index-4">For this latter issue, the visualizer actually provides a functionality that can improve the visualization of these instances. On the toolbar, there is a <span class="guilabel">Projection</span> menu where you can select a signature to be projected in the visualization. For selected signatures, the visualization will show its contents projected by each atom, with a new combobox at the bottom of the visualizer allowing the selection of the highlighted atom. In this particular case, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code> is a singleton signature, so we are only projecting over a single atom, making the ternary <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">aux_time</span></code> a binary relation in the visualization. Below is the result after projection.</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/modules/instance_03/filesystem.als#L78-L90"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance35.png" style="width: 500px;" />
</a>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/adding-fields-to-module-parameters"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/adding-fields-to-module-parameters</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</div>
<p class="sd-card-text">We’ve used the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module to impose a total ordering on timestamps, learn more about how it works.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../ordering/index.html#ordering"><span class="std std-ref">The predefined ordering module</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Higher-arity relations</div>
<p class="sd-card-text">The <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">aux_time</span></code> is a ternary field. Learn  how to use such higher-arity relations.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../nary-relations/index.html#nary-relations"><span class="std std-ref">Higher-arity relations</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Arrow multiplicity constraints</div>
<p class="sd-card-text">Learn how to use arrow multiplicity constraints, like the one used in fact <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time_mult</span></code>.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../bestiary/index.html#bestiary"><span class="std std-ref">Arrow multiplicity constraints</span></a></div>
</div>
</section>
<section id="private-declarations">
<h2>Private declarations<a class="headerlink" href="#private-declarations" title="Link to this heading">¶</a></h2>
<p id="index-5">To avoid using the projected ternary relation, we can derive a binary relation
from the auxiliary <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">aux_time</span></code> by declaring an auxiliary function that
projects away <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code>, as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fun</span> <span class="nf">time</span> <span class="p">:</span> <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">T</span> <span class="o">{</span>
  <span class="n">TimeAux</span><span class="o">.</span><span class="n">aux_time</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We want to provide this derived relation to including modules, and hide the fact
that it uses an auxiliary signature. Alloy allows any declaration in a module to
be marked as <em>private</em>. This makes the element inaccessible from any module that
includes the auxiliary module. In our example, we can make <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code> (and
the field within) private as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="k">one</span> <span class="kd">sig</span> <span class="nc">TimeAux</span> <span class="o">{</span>
  <span class="n">aux_time</span> <span class="p">:</span> <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">T</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code> is no longer visible in the file system module, but only
the derived relation <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code>. So the fact shown above would be rewritten
as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">time</span> <span class="o">{</span>
  <span class="k">all</span> <span class="n">d</span> <span class="p">:</span> <span class="n">Dir</span> <span class="o">|</span> <span class="n">d</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">time</span><span class="o">.*</span><span class="n">next</span>
<span class="o">}</span>
</pre></div>
</div>
<p>If you now generate an instance you’ll see the binary <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code> connecting objects to timestamps (labeled <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">$time</span></code> since it is a derived relation).</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/modules/instance_04/filesystem.als#L78-L90"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance44.png" style="width: 500px;" />
</a>
<p>Of course you can always customize the theme to hide timestamp atoms and show <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code> as an attribute.</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/modules/instance_05/filesystem.als#L78-L90"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance54.png" style="width: 500px;" />
</a>
<p>You may notice that, although private signatures are omitted, the corresponding
atoms still belong to the universe (there is no notion of private atom). So, for
instance, if you evaluate <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kc">univ</span></code> in the evaluator atoms from private
signatures will appear. In our file system example, you’ll see in the universe
an atom <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">timestamp</span><span class="o">/</span><span class="n">TimeAux$</span><span class="mi">0</span></code> representing the singleton auxiliary
signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">TimeAux</span></code>. Perhaps surprisingly, you’ll also see an atom
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">timestamp</span><span class="o">/</span><span class="n">ordering</span><span class="o">/</span><span class="n">Ord$</span><span class="mi">0</span></code>. This because the approach just presented is
precisely the one followed in <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">ordering</span></code> to introduce a total
ordering over a given parameter signature with a derived relation <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">next</span></code>,
and that atom corresponds to the singleton auxiliary signature introduced.</p>
<p>As a last note, you can include the same module multiple times with different
signature parameters. For instance, here we could additional declare
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kn">open</span> <span class="nn">timestamp</span><span class="o">[</span><span class="n">Entry</span><span class="p">,</span> <span class="n">Timestamp</span><span class="o">]</span></code> and an additional <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code> relation would assign timestamps to entries. Alloy will try to disambiguate calls to <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code> using its type system. For instance, the fact above would still be valid since from the type of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">d</span></code> it identifies the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">time</span></code> relation defined for objects. Nonetheless, it may help to open those modules with an alias using <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">as</span></code>.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/private-declarations"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules/private-declarations</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full models for this topic</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/modules</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
The instance evaluator</div>
<p class="sd-card-text">We’ve used the evaluator to validate our model, learn in more detail how it works.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../evaluator/index.html#evaluator-instance"><span class="std std-ref">The instance evaluator</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Type system</div>
<p class="sd-card-text">We’ve mentioned the Alloy type system and the disambiguation of overloaded identifiers. Learn more about it.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../type-system/index.html#type-system"><span class="std std-ref">Type system</span></a></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../ordering/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../type-system/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Type system</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-2025, Alcino Cunha, Nuno Macedo, Julien Brunel, David Chemouil
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Feb 16, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Module system</a><ul>
<li><a class="reference internal" href="#declaring-simple-modules">Declaring simple modules</a></li>
<li><a class="reference internal" href="#parametrized-modules">Parametrized modules</a></li>
<li><a class="reference internal" href="#adding-fields-to-module-parameters">Adding fields to module parameters</a></li>
<li><a class="reference internal" href="#private-declarations">Private declarations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "practicalalloy/practicalalloy.github.io");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>