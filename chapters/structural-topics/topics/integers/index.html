<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-02-16T20:25:24+00:00" /><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Signature facts" href="../signature-facts/index.html" /><link rel="prev" title="Handling recursion" href="../recursion/index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Working with integers - Practical Alloy</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/practicalalloy.css?v=2ee171b3" />
    <link crossorigin="anonymous" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #2a5adf;
  --color-brand-content: #2a5adf;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Practical Alloy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Practical Alloy</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about-alloy/index.html">About Alloy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about-book/index.html">About this book</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../structural-modeling/index.html">Structural modeling</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Advanced topics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subset-signatures/index.html">Subset signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enumerations/index.html">Enumeration signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commands in detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/index.html">Visualization customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nary-relations/index.html">Higher-arity relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluator/index.html">The instance evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bestiary/index.html">Arrow multiplicity constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../type-system/index.html">Type system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html">Module system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ordering/index.html">The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../relational-logic/index.html">A relational logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model-finding/index.html">Model finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-instances/index.html">Encoding test instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../recursion/index.html">Handling recursion</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Working with integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature-facts/index.html">Signature facts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../behavioral-modeling/index.html">Behavioral modeling</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../behavioral-topics/index.html">Advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/temporal-logic/index.html">A temporal logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/mutable-toplevel-signatures/index.html">Mutable top-level signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/pointwise-effects/index.html">Pointwise effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/macros/index.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/meta/index.html">Meta-capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/event-depiction/index.html">An idiom for event depiction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/scenarios/index.html">Encoding trace scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/evaluator/index.html">The trace evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/fairness/index.html">Safety, liveness, and fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/inductive-invariants/index.html">Inductive invariants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/sequences/index.html">Sequences</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../protocol-design/index.html">Protocol design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/chapters/structural-topics/topics/integers/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="working-with-integers">
<span id="integers"></span><h1>Working with integers<a class="headerlink" href="#working-with-integers" title="Link to this heading">¶</a></h1>
<p>Although using integers in Alloy may seem like a harmless decision, they have
some particularities that may lead to unpredictable behaviour. Moreover, due to
the nature of the procedures behind the Analyzer, using integers actually may
have considerable impact in the performance. Integers should only be used if the
specification actually requires arithmetic operations. For instance, identifiers
may be encoded as integers in the system implementation for convenience, but
will only need to be be tested for equality. Thus, during the system design such
an identifier can actually be represented by an uninterpreted atom. If we
additionally need to, for instance, compare identifiers, this can be achieved by
imposing a total order on the atoms of the signature. Nonetheless, there are of
course situations where we actually need to perform arithmetic operations over
integers. This chapter shows how this can be achieved in Alloy, and which
pitfalls to be aware of.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</div>
<p class="sd-card-text">Learn how to impose a total order on a signature and avoid using integers unless absolutely necessary.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../ordering/index.html#ordering"><span class="std std-ref">The predefined ordering module</span></a></div>
</div>
<section id="models-with-integers">
<h2>Models with integers<a class="headerlink" href="#models-with-integers" title="Link to this heading">¶</a></h2>
<p id="index-0">Integers are actually always enabled in every Alloy specification. For instance,
if you execute any <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">run</span></code> command with a default scope, and use the
Analyzer’s evaluator to check the value of expression <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> you will get
the following set.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">1</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">2</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">3</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">4</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">5</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">6</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">7</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span><span class="mi">8</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">0</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">2</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">3</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">4</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">5</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">6</span></code></p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">7</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> is the built-in signature containing all integer atoms. You can
also see that they always integrate the universe of discourse by
evaluating <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kc">univ</span></code>. You’ll also notice that these integers are finite
and that they are the 4-bit signed integers under Two’s-complement binary
representation. Being aware of these three points - integers are atoms,
bounded, and interpreted in binary - is essential to use integers in
Alloy soundly.</p>
<p>Signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> can be used as any other signature in the model, except
that it cannot be extended (like all built-in signatures). Fields can have type
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code>, and signatures can be declared as subsets of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code>. For
instance, let us return to the file system example from chapter
<a class="reference internal" href="../../../structural-modeling/index.html#structural-modeling"><span class="std std-ref">Structural modeling</span></a> and try to extend our model with file sizes. In
particular, we want to assign to each object an integer size, and also have a
distinguished integer atom representing the maximum capacity of the system. This
could be simply achieved as follows.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">one</span> <span class="kd">sig</span> <span class="nc">Capacity</span> <span class="k">in</span> <span class="nc">Int</span> <span class="o">{}</span>

<span class="k">abstract</span> <span class="kd">sig</span> <span class="nc">Object</span> <span class="o">{</span>
  <span class="n">size</span> <span class="p">:</span> <span class="k">one</span> <span class="kt">Int</span>
<span class="o">}</span>
</pre></div>
</div>
<p>After running the empty <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">run</span></code> command <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">example</span></code>, we could get an
instance such as the following, after some theme customizations (by default,
unconnected nodes of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> are set to hidden; we’ve turned this off, set
all integer atoms to be hidden, but then only subset <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Capacity</span></code> to be
shown).</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/integers/instance_01/filesystem.als#L79-L93"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance119.png" style="width: 500px;" />
</a>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/models-with-integers"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/models-with-integers</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
The instance evaluator</div>
<p class="sd-card-text">In this section we mentioned the evaluator. Learn in more detail how to use it to debug specification.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../evaluator/index.html#evaluator-instance"><span class="std std-ref">The instance evaluator</span></a></div>
</div>
</section>
<section id="integer-operations">
<h2>Integer operations<a class="headerlink" href="#integer-operations" title="Link to this heading">¶</a></h2>
<p>Let us the Analyzer’s evaluator to explore how to manipulate integers.  Integer
constants can occur in relational expressions (including in the model, unlike
other atoms). Start by evaluating, for instance, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span><span class="o">+</span><span class="mi">2</span></code>. While initially
surprising, getting the set of atoms <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="mi">1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="mi">2</span><span class="o">)}</span></code> was the only sensible
solution: as everything Alloy, expressions <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">2</span></code> are actually
singleton sets <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="mi">1</span><span class="o">)}</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="mi">2</span><span class="o">)}</span></code>, and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">+</span></code> denotes the union
of relations. For another sanity check, evaluate <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span><span class="o">-</span><span class="mi">1</span></code>. This evaluates to
the empty set <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{}</span></code>, and not to the integer <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">0</span></code>. Again, this is
because <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span></code> is the relation difference operator. Notice that, since these
are valid relational expressions, no errors or warnings are thrown.</p>
<p id="index-1">To perform arithmetic operations over integers, a special set of operators
must be used. The table below presents the native integer operators supported
by Alloy.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Operator</strong></p></td>
<td><p><strong>Description</strong></p></td>
<td><p><strong>Operator</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">add</span></code></p></td>
<td><p>Addition</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&lt;&lt;</span></code></p></td>
<td><p>Left shift</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">sub</span></code></p></td>
<td><p>Subtraction</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&gt;&gt;</span></code></p></td>
<td><p>Right shift w/ zero extension</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">mul</span></code></p></td>
<td><p>Multiplication</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&gt;&gt;&gt;</span></code></p></td>
<td><p>Right shift w/ sign extension</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">div</span></code></p></td>
<td><p>Division</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&gt;</span></code></p></td>
<td><p>Greater than</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">rem</span></code></p></td>
<td><p>Remainder</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&lt;</span></code></p></td>
<td><p>Less than</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">min</span></code></p></td>
<td><p>Minimum integer</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&gt;=</span></code></p></td>
<td><p>Greater than or equal to</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">max</span></code></p></td>
<td><p>Maximum integer</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&lt;=</span></code>, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">=&lt;</span></code></p></td>
<td><p>Less than or equal to</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">fun</span><span class="o">/</span><span class="n">next</span></code></p></td>
<td><p>Order relation</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code>, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">int</span></code></p></td>
<td><p>Set to integer conversion</p></td>
</tr>
</tbody>
</table>
</div>
<p id="index-2">The negation of the comparison formulas can also be written by placing the
negation operator next to the comparison operator (<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">R</span> <span class="ow">not</span> <span class="o">&lt;</span> <span class="n">S</span></code> or <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">R</span>
<span class="o">!&lt;</span> <span class="n">S</span></code> for <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="ow">not</span> <span class="o">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">S</span><span class="o">)</span></code>, for example). The expressions that we evaluated
above should actually be written as <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span> <span class="n">fun</span><span class="o">/</span><span class="n">add</span> <span class="mi">2</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span> <span class="n">fun</span><span class="o">/</span><span class="n">sub</span> <span class="mi">1</span></code>.
As expected, the result is again a singleton set that contain a single integer
atom. By default, Alloy also imports a <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">util</span><span class="o">/</span><span class="n">integer</span></code> utility module that
provides friendlier function and predicate versions of these operators. Some of
those are listed below, but you can consult the full module through menu option
<span class="menuselection">File ‣ Open Sample Models…</span>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Function</strong></p></td>
<td><p><strong>Description</strong></p></td>
<td><p><strong>Predicate</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">add</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">plus</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p>
</td>
<td><p>Addition</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">gt</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Greater than</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">sub</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">minus</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p>
</td>
<td><p>Subtraction</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">lt</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Less than</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">mul</span><span class="o">[</span><span class="n">ns</span> <span class="p">:</span> <span class="k">set</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Multiplication</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">gte</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Greater than or equal to</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">min</span><span class="o">[</span><span class="n">ns</span> <span class="p">:</span> <span class="k">set</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Minimum of a set</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">lte</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Less than or equal to</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">max</span><span class="o">[</span><span class="n">ns</span> <span class="p">:</span> <span class="k">set</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Maximum of a set</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">eq</span><span class="o">[</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Equal</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">max</span></code></p></td>
<td><p>Maximum integer</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">pos</span><span class="o">[</span><span class="n">n</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Positive</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">min</span></code></p></td>
<td><p>Minimum integer</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">neg</span><span class="o">[</span><span class="n">n</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Negative</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">next</span></code></p></td>
<td><p>Order relation</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">nonpos</span><span class="o">[</span><span class="n">n</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Non-positive</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">prev</span></code></p></td>
<td><p>Reversed order relation</p></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">nonneg</span><span class="o">[</span><span class="n">n</span> <span class="p">:</span> <span class="kt">Int</span><span class="o">]</span></code></p></td>
<td><p>Non-nositive</p></td>
</tr>
</tbody>
</table>
</div>
<p>Since everything is a relation, integer operations actually apply to any set of
atoms, even if it not singleton integer atom. This is something that is not used
often, but since this throws no error, it is important to be aware of their
semantics (arithmetic over non-unary relations always throws a type-error).
Whenever an integer operation is applied to a set, the latter is implicitly cast
into a single integer value, and the resulting integer wrapped back into a
singleton set. The implicit conversion of set to an integer is done by applying
the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code> operator. If the relation is a singleton set, this will just
result in the value of its atom, but if there are multiple integer values in the
set, they will be summed together. So <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">).</span><span class="n">plus</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span></code> is actually (the
singleton set) 6, and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">).</span><span class="n">plus</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span></code> is still 4. Also, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code> works
on sets that contain atoms other than integer: they will just be ignored. If the
set contains no integer atom (e.g., <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">3</span><span class="o">.</span><span class="n">plus</span><span class="o">[</span><span class="n">Root</span><span class="o">]</span></code>), a type-error will
effectively be thrown. This also highlights a difference between the relational
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">=</span></code> and the integer <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">eq</span></code>: while <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Root</span></code> is false,
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">1</span><span class="o">.</span><span class="n">eq</span><span class="o">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Root</span><span class="o">]</span></code> is actually true.</p>
<p>Let us get back to the example and try to fix some of the issues evident in the
instance above. For instance, we expect file sizes to be positive. This can be
easily achieved with the following fact.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">positive_sizes</span> <span class="o">{</span>
  <span class="c1">// All file sizes are positive</span>
  <span class="k">all</span> <span class="n">f</span> <span class="p">:</span> <span class="n">File</span> <span class="o">|</span> <span class="n">gt</span><span class="o">[</span><span class="n">f</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Another constraint that we would like to impose is that sum of the size of all
files is less than the established capacity. However, using the operators we’ve
seen so far, this is not possible to encode. At first sight, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span>
<span class="n">File</span><span class="o">.</span><span class="n">size</span></code> could perhaps be used to sum the size of all files. However, if there
are multiple files with the same size, that integer atom will only occur once in
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">File</span><span class="o">.</span><span class="n">size</span></code> and thus the sum will yield an incorrect value.</p>
<p id="index-3">This can be addressed with another important integer operator, the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code>
quantifier (not to be confused with the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code> unary operator). The
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span></code> quantifier iterates over a set of atoms and adds up the value of an
integer expression over the quantified variable. Back to our example, the size
of all files could be written as <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">sum</span> <span class="n">f</span> <span class="p">:</span> <span class="n">File</span> <span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">size</span></code>, iterating over
all files and summing their size. The following fact would enforce the
desired constraint on capacity.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">below_capactiy</span> <span class="o">{</span>
  <span class="c1">// The sum of the size of all files cannot exceed the capacity</span>
  <span class="o">(</span><span class="k">sum</span> <span class="n">f</span> <span class="p">:</span> <span class="n">File</span> <span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">size</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="n">Capacity</span>
<span class="o">}</span>
</pre></div>
</div>
<p id="index-4">One last, but still very useful integer operator, is the cardinality
operator <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">#</span></code>, which calculates the number of atoms in a relation. For
instance for a given directory <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">d</span></code>, expression <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">#(</span><span class="n">d</span><span class="o">.</span><span class="n">entries</span><span class="o">)</span></code>
returns the number of entries of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">d</span></code>. For instance, the following command
will search for instances where the root has 3 objects.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">run</span> <span class="n">full_root</span> <span class="o">{</span>
  <span class="o">#(</span><span class="n">Root</span><span class="o">.</span><span class="n">entries</span><span class="o">)</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">}</span> <span class="k">for</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Let us run this command and validate our model with the additional constraints.
If you’re not aware of Alloy’s integer semantics, you may be surprised to find
the following instance, where the sum of the size of the files clearly exceeds
the capacity.</p>
<a class="reference external image-reference" href="https://github.com/practicalalloy/models/blob/2024-02-28/structural-topics/integers/instance_02/filesystem.als#L93-L108"><img alt="Get the code to generate this instance." class="align-center" src="../../../../_images/instance27.png" style="width: 500px;" />
</a>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/integer-operations"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/integer-operations</span></a></div>
</div>
</section>
<section id="dealing-with-integer-overflows">
<h2>Dealing with integer overflows<a class="headerlink" href="#dealing-with-integer-overflows" title="Link to this heading">¶</a></h2>
<p id="index-5">Alloy implements a wrap-around semantics for integers, and given the limited
number of available integer atoms, and the exhaustive nature of the Alloy
analyses procedures, integer overflows are a common issue that must be
addressed. With the default scope on integers they range from -8 to 7, so in the
instance above <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="mi">5</span><span class="o">.</span><span class="n">plus</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">plus</span><span class="o">[</span><span class="mi">6</span><span class="o">]</span></code> is effectively -4, which is smaller
than the capacity 4 (you can test it in the evaluator).</p>
<p>The number of integer atoms available during analysis is defined by the scope on
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> on the command declaration, as for other regular signatures. This
scope does not set the number of integer atoms in the universe,  but rather the
size of their bitwise representation. This scope is 4 by default, which results
in the 16 integers from -8 to 7. The scope for <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> is always exactly
defined as the integers available with the specified bitwidth (unlike the other
signatures whose scope determines an upper-bound). Also, changing the overall
scope of a command does not change the scope on <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code>: it must be
explicitly set.</p>
<p>Nonetheless, our current model will exhibit overflows regardless of the scope for
integers, because there are always instances where the size of the files will
overflow. Although this may look cumbersome, overflows are a common issue in
real systems, Alloy just happens to illustrate it in a smaller scale. So rather
that completely forbid overflows, we should instead guarantee that our system
model never reaches a state where such overflows occur. For instance, we can
limit the size of objects with the following fact, that takes into consideration
the maximum available integer and the number of objects in the universe.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">size_limits</span> <span class="o">{</span>
  <span class="c1">// Guarantee file sizes do not overflow</span>
  <span class="k">all</span> <span class="n">f</span> <span class="p">:</span> <span class="n">File</span> <span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="n">div</span><span class="o">[</span><span class="n">max</span><span class="p">,</span> <span class="o">#</span><span class="n">File</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Behind the curtain, the reason why integers behave like this in Alloy is because
the Analyzer relies on SAT solvers for the analyses, which support only Boolean
variables. Thus, integers are converted into bit strings during analysis, with a
Boolean variable representing each bit, while integer operations are converted
to their bitwise counter-parts. A side-effect of this is that large integer
bitwidth scopes have a considerable toll on performance.</p>
<p id="index-6">Alloy has the ability to ignore instances where any overflow
occurs. This can be turned on in the menu option <span class="menuselection">Options ‣
Prevent overflows</span>. Any <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">run</span></code> command will no longer present instances
with overflows, and these will also be ignored when running <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">check</span></code>
commands. However, bear in mind that this will completely disregard instances
where any overflow occurs, which may give a false sense of security. For
instance, the obviously false <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">check</span></code> command below actually finds no
counter-example when overflows are forbidden.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">check</span> <span class="n">big_files</span> <span class="o">{</span>
  <span class="k">all</span> <span class="n">f</span> <span class="p">:</span> <span class="n">File</span> <span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">10</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This is because the constant 10 cannot be represented with the default bitwidth
scope of 4 and overflows.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/dealing-with-integer-overflows"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/integers/dealing-with-integer-overflows</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Visualization customization</div>
<p class="sd-card-text">Throughout the chapter we’ve customized the visualization of instances. Learn in more detail how this can ease instance interpretation.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../visualization/index.html#viz-customization"><span class="std std-ref">Visualization customization</span></a></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../signature-facts/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Signature facts</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../recursion/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Handling recursion</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-2025, Alcino Cunha, Nuno Macedo, Julien Brunel, David Chemouil
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Feb 16, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Working with integers</a><ul>
<li><a class="reference internal" href="#models-with-integers">Models with integers</a></li>
<li><a class="reference internal" href="#integer-operations">Integer operations</a></li>
<li><a class="reference internal" href="#dealing-with-integer-overflows">Dealing with integer overflows</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "practicalalloy/practicalalloy.github.io");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>