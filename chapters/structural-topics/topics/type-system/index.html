<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-02-16T20:25:24+00:00" /><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Module system" href="../modules/index.html" /><link rel="prev" title="Arrow multiplicity constraints" href="../bestiary/index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Type system - Practical Alloy</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/practicalalloy.css?v=2ee171b3" />
    <link crossorigin="anonymous" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #2a5adf;
  --color-brand-content: #2a5adf;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Practical Alloy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Practical Alloy</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about-alloy/index.html">About Alloy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about-book/index.html">About this book</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../structural-modeling/index.html">Structural modeling</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Advanced topics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subset-signatures/index.html">Subset signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enumerations/index.html">Enumeration signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commands in detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/index.html">Visualization customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nary-relations/index.html">Higher-arity relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluator/index.html">The instance evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bestiary/index.html">Arrow multiplicity constraints</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Type system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html">Module system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ordering/index.html">The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../relational-logic/index.html">A relational logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model-finding/index.html">Model finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-instances/index.html">Encoding test instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../recursion/index.html">Handling recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integers/index.html">Working with integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature-facts/index.html">Signature facts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../behavioral-modeling/index.html">Behavioral modeling</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../behavioral-topics/index.html">Advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Advanced topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/temporal-logic/index.html">A temporal logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/mutable-toplevel-signatures/index.html">Mutable top-level signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/pointwise-effects/index.html">Pointwise effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/macros/index.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/meta/index.html">Meta-capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/event-depiction/index.html">An idiom for event depiction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/scenarios/index.html">Encoding trace scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/evaluator/index.html">The trace evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/fairness/index.html">Safety, liveness, and fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/inductive-invariants/index.html">Inductive invariants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/sequences/index.html">Sequences</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../protocol-design/index.html">Protocol design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/chapters/structural-topics/topics/type-system/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="index-0">
<span id="type-system"></span><span id="id1"></span><h1>Type system<a class="headerlink" href="#index-0" title="Link to this heading">¶</a></h1>
<p>The Alloy language is notably flexible, and so is its type system. Alloy’s type
system was designed to detect three types of errors that can occur in relational expressions:</p>
<ul class="simple">
<li><p><em>arity errors</em>, when an operator is applied to relations of incorrect
or mismatching arities;</p></li>
<li><p><em>irrelevance warnings</em>, when an expression always yields an empty set
regardless of the instance and thus is irrelevant;</p></li>
<li><p><em>ambiguity errors</em>, when the type system cannot disambiguate between various overloaded relations.</p></li>
</ul>
<section id="arity-errors">
<span id="index-1"></span><h2>Arity errors<a class="headerlink" href="#arity-errors" title="Link to this heading">¶</a></h2>
<p>In Alloy, all relations must have a uniform arity greater than 0 (i.e., all its
tuples must have the same positive arity). A first consequence of this, is that
relational operations union <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">+</span></code>, intersection <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&amp;</span></code>, difference
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">-</span></code> and override <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">++</span></code>, are only well-typed if applied two to
relations of the same arity. For instance, the following throws an arity error,
since <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">File</span></code> is unary and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> binary.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">no</span> <span class="n">File</span> <span class="o">+</span> <span class="n">entries</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/log16.png"><img alt="../../../../_images/log16.png" class="align-center" src="../../../../_images/log16.png" style="width: 400px;" />
</a>
<p>To ensure the positive arity, you also cannot compose two relations of arity 1
(recall that the composition of an <em>n</em>-ary and an <em>m</em>-ary relation results in a
relation of arity <em>n+m-2</em>). So formulas such as the following are invalid in Alloy.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">all</span> <span class="n">o</span> <span class="p">:</span> <span class="n">Object</span> <span class="o">|</span> <span class="n">o</span><span class="o">.</span><span class="n">Dir</span>
</pre></div>
</div>
<p>Finally, some operators can only be applied to relations with a specific arity.
Namely, the transpose <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">~</span></code>, transitive closure <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">^</span></code> and reflexive
transitive closure <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">*</span></code> can only be applied to binary relations, while the
domain restriction <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">&lt;:</span></code> and range restriction <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">:&gt;</span></code> require a unary
relation on the left-hand and right-hand side, respectively.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/arity-errors"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/arity-errors</span></a></div>
</div>
</section>
<section id="irrelevance-warnings">
<span id="index-2"></span><h2>Irrelevance warnings<a class="headerlink" href="#irrelevance-warnings" title="Link to this heading">¶</a></h2>
<p>Alloy allows relations between different signatures to be combined, as long as
they have the same arity. For instance, even though field <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> is
only defined for directories, we’ve actually applied it to arbitrary objects in the
fact <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">no_indirect_containment</span></code>, by calculating the closure of
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span><span class="o">.</span><span class="n">object</span></code>: it just happens that <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> will return an empty set for files. Likewise,
expressions such as <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span><span class="o">.</span><span class="n">entries</span></code> are also perfectly acceptable. You
can also put together atoms of signatures that are completely unrelated. The union
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span></code> is a valid expression even though objects and names belong
to distinct top-level signatures. And <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span><span class="o">).</span><span class="n">entries</span></code> is also
acceptable, although it is not particularly useful since only the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span></code>
atoms of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code> will contribute to the final result.</p>
<p>Concerning “mismatching” types, Alloy type system only reports warning to the user when an
expression will necessarily result in the empty set, and in which case it is considered
<em>irrelevant</em>. For instance, suppose we add the following fact to our model.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">fact</span> <span class="nf">irrelevance_warning</span> <span class="o">{</span>
  <span class="k">no</span> <span class="n">Dir</span><span class="o">.</span><span class="n">name</span>
<span class="o">}</span>
</pre></div>
</div>
<p>If we now execute any command we would get a warning: the Analyzer refuses to
execute the command and tells us that the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">.</span></code> operator  will always yield an empty set.</p>
<a class="reference internal image-reference" href="../../../../_images/log24.png"><img alt="../../../../_images/log24.png" class="align-center" src="../../../../_images/log24.png" style="width: 450px;" />
</a>
<p>You’ll get similar warning if you write an expression such as <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span> <span class="o">&amp;</span>
<span class="n">File</span></code>, since the two relations being intersected are always disjoint. This
warning issued by Alloy’s type system is one of the advantages of using
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="k">extends</span></code> to declare disjoint subset signatures, instead of relying on
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="ow">in</span></code> and additional facts.</p>
<p id="index-3">Note however that this is merely a warning to the user, and that the Analyzer
can actually still execute the requested command. By
default that option is disabled, but you can enable it through menu option
<span class="menuselection">Options ‣ Allow warnings</span>. This will also allow models with
other kinds of warnings to be executed (such as unused variable warnings). But
in general irrelevance warnings are most likely specification errors made by the
user and should be fixed. For instance, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span><span class="o">.</span><span class="n">name</span></code> could be a mistake
easily introduced by a distracted user. If the user effectively wants to write
an expression that always denotes an empty set, then the special constant <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kc">none</span></code>
should be used instead, making that intention explicit.</p>
<p id="index-4">To detect irrelevant expressions, Alloy type system calculates an expression
<em>bounding type</em>, an upper-bound on the value of that expression. If that
bounding type is empty, the expression is irrelevant and a warning is thrown.
Bounding type inference is guided by the abstract syntax and is bottom-up. What
is interesting is that the type inference uses the same operators as the
expressions for which the type is being inferred, but rather than manipulating
tuple sets of atoms, it manipulates tuple sets of types.</p>
<p>The type of an expression is a tuple set of <em>atomic</em> types. There is an atomic
type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> for every extension signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> that is not
extended further. For a non-abstract signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">A</span></code> that has some extension, an atomic type is also created to denote the atoms that do not
belong to any of its extensions. This remainder atomic type is denoted by
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">$A</span></code>. For our example, the atomic types corresponding to declared signatures are
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Root</span></code>, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">File</span></code>, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Entry</span></code>, while <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">$Dir</span></code>
represents the remainder directories (i.e., directories other than the root).</p>
<p>The bounding type of each signature and field is then specified by a tuple set
of atomic types. The bottom-level signatures simply have its own type. For
instance, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">File</span></code> has type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">File</span><span class="o">)}</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code> type
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Name</span><span class="o">)}</span></code>. Other signatures have a type that is the union of its
sub-signatures. So for our example, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span></code> has type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)}</span></code>
and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code> type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span></code>. The bounding type of
fields is defined in a similar way considering the type of the related
signatures. For instance, <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">name</span></code> simply has type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="p">,</span><span class="n">Name</span><span class="o">)}</span></code>,
while <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> has type <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code>. The bounding
type of an expression is calculated by directly applying the operation at the
bounding type level. Below is the process for expression <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="n">Object</span> <span class="o">+</span>
<span class="n">Name</span><span class="o">).</span><span class="n">entries</span></code>. For each sub-expression, the application of the operator
at the type level is shown to depict how the bounding type is calculated.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Name</span><span class="o">)}</span></code></p>
</td>
<td></td>
</tr>
<tr class="row-even"><td colspan="2"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span> <span class="o">+</span> <span class="o">{(</span><span class="n">Name</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-odd"><td colspan="3"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span><span class="o">).</span><span class="n">entries</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
</tbody>
</table>
</div>
<p>In the end, an expression (other
than <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kc">none</span></code>) is considered irrelevant, if its bounding type an empty tuple set. For instance, below is the bounding type calculation
for irrelevant expression <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span><span class="o">.</span><span class="n">name</span></code>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="p">,</span><span class="n">Name</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-even"><td colspan="2"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Dir</span><span class="o">.</span><span class="n">name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)}.{(</span><span class="n">Entry</span><span class="p">,</span><span class="n">Name</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{}</span></code></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/irrelevance-warnings"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/irrelevance-warnings</span></a></div>
</div>
</section>
<section id="ambiguity-errors">
<span id="index-5"></span><h2>Ambiguity errors<a class="headerlink" href="#ambiguity-errors" title="Link to this heading">¶</a></h2>
<p>Alloy models can contain overloaded fields as long as the type system is able to
disambiguate which version is being called in each expression. Let us consider
an alternative version of our file system model, where both field
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> of directories and field <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">object</span></code> of entries happened to
have the same name <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code>.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="kd">sig</span> <span class="nc">Dir</span> <span class="k">extends</span> <span class="nc">Object</span> <span class="o">{</span>
  <span class="n">contents</span> <span class="p">:</span> <span class="k">set</span> <span class="n">Entry</span>
<span class="o">}</span>

<span class="kd">sig</span> <span class="nc">Entry</span> <span class="o">{</span>
  <span class="n">contents</span> <span class="p">:</span> <span class="k">one</span> <span class="n">Object</span><span class="p">,</span>
  <span class="n">name</span>     <span class="p">:</span> <span class="k">one</span> <span class="n">Name</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Commands such as the following are perfectly acceptable, because the Analyzer is
able to infer that the relevant <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code> field in that case is the one
for directories.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">run</span> <span class="n">not_ambiguous</span> <span class="o">{</span>
  <span class="k">some</span> <span class="n">Root</span><span class="o">.</span><span class="n">contents</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In fact, Alloy is able to disambiguate all occurrences of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code> and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">object</span></code> in the definitions of the system model after they are both renamed to <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code>. However, if you call field <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code> in a context that does not allow for
disambiguation, you will get an ambiguity error due to multiple matches, such as
in the command below.</p>
<div class="highlight-practicalalloy notranslate"><div class="highlight"><pre><span></span><span class="k">run</span> <span class="n">ambiguous</span> <span class="o">{</span>
  <span class="k">some</span> <span class="n">contents</span>
<span class="o">}</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/log3.png"><img alt="../../../../_images/log3.png" class="align-center" src="../../../../_images/log3.png" style="width: 350px;" />
</a>
<p id="index-6">To perform this disambiguation, Alloy builds on the inference of the bounding
types presented above to calculate the <em>relevance type</em> of an expression.  After
the bounding type of an expression is calculated, a top-down phase determines
which expressions contributed to that bound. The relevance type of the outermost
expression is its bounding type, and the relevance type of a sub-expression is the
subset of its bounding type that contributed to the parent expression relevance
type. Unlike the bounding type, the relevance type of an expression depends on
the context it occurs, so the same expression can have different relevance types
in different contexts. As an example, below is the calculus of the relevance
types for expression <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span><span class="o">).</span><span class="n">entries</span></code>. For each expression, the
bounding type is shown, and also the subset of that that corresponds to its relevance
type.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td colspan="3"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">(</span><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span><span class="o">).</span><span class="n">entries</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-even"><td colspan="2"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span> <span class="o">+</span> <span class="n">Name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">entries</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Name</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{}</span></code></p>
</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>So <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code> does not contribute to the final expression, nor does the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">File</span></code>
portion of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code>.</p>
<p>To disambiguate between overloaded fields, the call to an overloaded field is replaced by
the union of all fields with the same name. Then, when calculating the relevance
type of the expression, if only one of those fields contributed to the final
value, the overloading is disambiguated. Otherwise an ambiguity error is thrown. Below is the process for expression
<code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Root</span><span class="o">.</span><span class="n">contents</span></code>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td colspan="3"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Root</span><span class="o">.(</span><span class="n">contents</span> <span class="o">+</span> <span class="n">contents</span><span class="o">)</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Root</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="o">)}</span></code></p>
</td>
<td colspan="2"><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span> <span class="o">+</span> <span class="n">contents</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry</span><span class="p">,</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry</span><span class="p">,</span><span class="n">File</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">$Dir</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry</span><span class="o">)}</span></code></p>
</td>
<td><p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{(</span><span class="n">Entry</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry</span><span class="p">,</span><span class="n">$Dir</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry</span><span class="p">,</span><span class="n">File</span><span class="o">)}</span></code></p>
<p><code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="o">{}</span></code></p>
</td>
</tr>
</tbody>
</table>
</div>
<p>So the Analyzer infers that the <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">contents</span></code> of <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Object</span></code> is the only one that contributes
to the expression, so there is no ambiguity.</p>
<p>More information about Alloy’s type system can be found in <a class="reference internal" href="../../../../bibliography.html#fse04" id="id2"><span>[FSE04]</span></a>.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/ambiguity-errors"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/ambiguity-errors</span></a></div>
</div>
</section>
<section id="a-note-on-predefined-types">
<span id="index-7"></span><span id="built-in"></span><h2>A note on predefined types<a class="headerlink" href="#a-note-on-predefined-types" title="Link to this heading">¶</a></h2>
<p>This chapter focused mostly on how Alloy’s type system deals with user defined
signatures. But the reader may wonder if Alloy has any predefined types, such as
integers or strings. And if that is the case, why haven’t we used, for instance,
strings to represent names of objects in our file system example, instead of
declaring a new signature <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">Name</span></code>?</p>
<p>Alloy does indeed have a couple of predefined types, namely
signatures <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> for (bounded) integers and <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">String</span></code> for strings.
However, these types should be avoided as much as possible, because their
semantics is substantially more tricky than that of regular signatures, and
analysis can be confusing and somehow crippled when using them (in particular
with strings).</p>
<p>The fact is that in many cases, the semantics of such signatures is just too
rich for the intended use: for example, strings can be concatenated and there is
the notion of one string being a substring of another, but for the file system
specification none of this is of interest when specifying the abstract concept
of a name. The only thing we will need in this case is to check for name
equality, and normal signatures and atoms already provide us that basic
semantics.</p>
<p>People also tend to use integers when they actually need something much simpler,
semantics-wise. For example, we sometimes need to specify a signature where
there is some total order imposed over its atoms and, at first sight, integers
are very convenient for that. However, integers have a richer semantics than
just being a total order, and we can easily axiomatise a total order on a
regular signature with some simple facts and thus avoid the analysis drawbacks
that come with using integers.</p>
<p>So, when should you use <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">String</span></code> or <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code>? The former has very
little use, and actually, even if recognized by the Analyzer, is not even part
of standard Alloy. The latter is sometimes useful, for example when you
effectively need to perform arithmetic operations in the specification, such as
additions or subtractions. The <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="kt">Int</span></code> type is discussed in detail in a
dedicated advanced topic.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-2 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-file-badge" viewBox="0 0 16 16" aria-hidden="true"><path d="M2.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h3.5a.75.75 0 0 1 0 1.5h-3.5A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8a1.75 1.75 0 0 1 1.508.862.75.75 0 1 1-1.289.768.25.25 0 0 0-.219-.13h-8Z"></path><path d="M8 7a3.999 3.999 0 0 1 7.605-1.733 4 4 0 0 1-1.115 4.863l.995 4.973a.75.75 0 0 1-.991.852l-2.409-.876a.248.248 0 0 0-.17 0l-2.409.876a.75.75 0 0 1-.991-.852l.994-4.973A3.994 3.994 0 0 1 8 7Zm4-2.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0 6.5c-.373 0-.745-.051-1.104-.154l-.649 3.243 1.155-.42c.386-.14.81-.14 1.196 0l1.155.42-.649-3.243A4.004 4.004 0 0 1 12 11Z"></path></svg> Alloy model</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Full model for the section</div>
<p class="sd-card-text">Download and explore the files relevant for the model at this point of the book.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/a-note-on-built-in-types"><span>https://github.com/practicalalloy/models/tree/2024-02-28/structural-topics/type-system/a-note-on-built-in-types</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
A relational logic primer</div>
<p class="sd-card-text">Learn about all operators provided by Alloy’s relational logic and their arity restrictions.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../relational-logic/index.html#relational-logic"><span class="std std-ref">tocdepth</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Working with integers</div>
<p class="sd-card-text">Some models effectively require integers. Learn what are their limitations and how to properly use them in Alloy.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../integers/index.html#integers"><span class="std std-ref">Working with integers</span></a></div>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-beaker" viewBox="0 0 16 16" aria-hidden="true"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
The predefined <code class="code highlight alloy practicalalloy docutils literal highlight-practicalalloy"><span class="n">ordering</span></code> module</div>
<p class="sd-card-text">Learn how to impose a total order on a signature and avoid using integers unless absolutely necessary.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference internal" href="../ordering/index.html#ordering"><span class="std std-ref">The predefined ordering module</span></a></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../modules/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Module system</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../bestiary/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Arrow multiplicity constraints</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-2025, Alcino Cunha, Nuno Macedo, Julien Brunel, David Chemouil
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Feb 16, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Type system</a><ul>
<li><a class="reference internal" href="#arity-errors">Arity errors</a></li>
<li><a class="reference internal" href="#irrelevance-warnings">Irrelevance warnings</a></li>
<li><a class="reference internal" href="#ambiguity-errors">Ambiguity errors</a></li>
<li><a class="reference internal" href="#a-note-on-predefined-types">A note on predefined types</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "practicalalloy/practicalalloy.github.io");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>